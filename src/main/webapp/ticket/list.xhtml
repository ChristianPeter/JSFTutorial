<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                template="/template/template.xhtml">
    <ui:define name="content">
        Hello from Facelets
        #{ticketOverview.page}
        User: #{request.userPrincipal}
        <h:form>

            <h:commandButton value="prev" actionListener="#{ticketOverview.prev}">
                <f:ajax render=":tableForm:list pageNo" immediate="true"/>
            </h:commandButton>

            <h:inputText value="#{ticketOverview.page}" id="pageNo">
                <f:ajax event="change" render=":tableForm:list" execute="@form" listener="#{ticketOverview.updateList}"/>
            </h:inputText>

            <h:commandButton value="next" actionListener="#{ticketOverview.next}">
                <f:ajax render=":tableForm:list pageNo" immediate="true"/>
            </h:commandButton>

        </h:form>
        <h:form id="tableForm">
            <h:commandButton value="New ticket" action="#{ticketDetailPage.createTicket()}"/>
            <h:panelGroup id="list">

                <ul>            
                    <ui:repeat value="#{ticketOverview.allTicketsPaginated}" var="ticket">
                        <li>
                            <div>
                                <div><h:commandLink value="edit" action="#{ticketDetailPage.editTicket(ticket)}"/></div>
                                <div>#{ticket.subject}</div>
                                <div>#{ticket.description}</div>
                                <div>#{ticket.creator.name}</div>
                                <div>#{ticket.ticketStatus}</div>
                                <div>#{ticket.submittedDate}</div>
                            </div>
                        </li>
                    </ui:repeat>
                </ul>
            </h:panelGroup>
        </h:form>


        <h:form>
            #{logoutHelper}
            <h:commandButton value="logout" action="#{logoutHelper.logout}"/>
        </h:form>
    </ui:define>
</ui:composition>
